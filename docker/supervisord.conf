[supervisord]
nodaemon=true
logfile=/opt/logs/supervisord.log
pidfile=/var/run/supervisord.pid
user=root

[program:xvfb]
command=/usr/bin/Xvfb :99 -screen 0 1280x720x24 -ac
autorestart=true
stdout_logfile=/opt/logs/xvfb.log
stderr_logfile=/opt/logs/xvfb-error.log
priority=100

[program:x11vnc]
command=/usr/bin/x11vnc -display :99 -forever -shared -passwd browserpilot -noxdamage
autorestart=true
stdout_logfile=/opt/logs/x11vnc.log
stderr_logfile=/opt/logs/x11vnc-error.log
priority=200
depends_on=xvfb

[program:novnc]
command=/usr/share/novnc/utils/novnc_proxy --vnc localhost:5900 --listen 6080 --web /usr/share/novnc
autorestart=true
stdout_logfile=/opt/logs/novnc.log
stderr_logfile=/opt/logs/novnc-error.log
priority=300
depends_on=x11vnc

[program:app]
command=python3 main.py
directory=/app
autorestart=true
stdout_logfile=/opt/logs/app.log
stderr_logfile=/opt/logs/app-error.log
priority=400
depends_on=xvfb
environment=DISPLAY=":99"